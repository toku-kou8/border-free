<%= render "students/shared/header" %>
<% week = ["日", "月", "火", "水", "木", "金", "土"] %>
<p id="notice"><%= notice %></p>

<div class="container" style="height: 1000px;">
  <div class="text-center mt-3">
    <h1 class="text-center mt-5 undertitle">授業詳細</h1>
  </div>
  <div class="row">
    <div class="col-md-4 offset-md-1">
      <table class="table">
        <tr>
          <th>授業日</th>
          <td><%= @lesson.start_time.strftime("20%y/%m/%d %H:%M~") %></td>
        </tr>
        <tr>
          <th>先生</th>
          <td><%= @lesson.teacher.name %></td>
        </tr>
        <tr>
          <th>科目</th>
          <td><%= @lesson.subject.name %></td>
        </tr>
      </table>
    </div>
    <div class="col-md-6 offset-md-1">
      <div class="mb-3">
        <h5>講師コメント</h5>
        <div>
          <%= @lesson.teacher_comment %>
        </div>
      </div>
      <div class="mb-5">
        <h5>生徒コメント</h5>
        <div>
          <%= @lesson.student_comment %>
        </div>
      </div>
      <div class="mb-2">
        <h5>評価</h5>
        <div id="star-rate"></div>
      </div>
      <script>
        $('#star-rate').raty({
          size      : 36,
          starOff   : '<%= asset_path('star-off.png') %>',
          starOn    : '<%= asset_path('star-on.png') %>',
          half      : false,
          readOnly: true,
          score: <%= @lesson.star %>,
        });
      </script>
      <div class="mt-5">
        <%= form_with model: @lesson, url: student_class_path(@lesson), method: :patch do |f| %>
        <div class="form-tag">
          <%= f.label :student_comment, 'コメント更新', class: 'control-label ml-3 h5' %><br>
          <%= f.text_area :student_comment, size: "50x5" %>
        </div>
        <div class="form-group row" id="star">
          <%= f.label :star,'評価 ', class: 'col-md-3 col-form-label' %>
          <%= f.hidden_field :star, id: :review_star %>
        </div>
        <div class="submit m-3">
          <%= f.submit "更新", class: 'btn btn-success' %>
        </div>

        <!-- 評価javascript -->
        <script>
        $('#star').raty({
          size     : 36,
          starOff:  '<%= asset_path('star-off.png') %>',
          starOn : '<%= asset_path('star-on.png') %>',

          scoreName: 'lesson[star]',
          half: false,
        });
        </script>
        <% end %>
      </div>
    </div>
  </div>
</div>